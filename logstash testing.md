 /usr/share/logstash/bin/logstash -e 'input { stdin { codec => json_lines } } filter { split { field => "recipients" } } output { stdout {} }'




 /usr/share/logstash/bin/logstash -e 'input { stdin { codec => json_lines } } filter { split { field => "recipients" } mutate { replace => { "queued_as" => "%{recipients[queued_as]}" }}  } output { stdout {} }'


sample data to use:


    {     "dkim_valid_sig": [       "mailroute.net"     ],     "type": "amavis",     "quar_type": "M",     "message": "23636-14 PASS CleanTag tj@mailroute.net -> am@terramar.net,tj@terramar.net",     "protocol": "LMTP",     "mail_id": "2D3betNxiywI",     "log_id": "23636-14",     "quarantine": "am@terramar.net",     "client_ip": "64.237.50.187",     "queued_as": [       "47b8gL2LMjz1JBRV-old",       "47b8gL2VHsz1JBSp-old"     ],          "queue_id": "47b8gK6y8Dz1JBJf-old",     "@timestamp": "2019-12-15T03:15:58.158Z",     "partition": "52",     "smtp_code": [       "250-old"     ],     "sid": "1169435236",     "policy_banks": [],     "content_type": "CleanTag",     "user_agent": "Apple Mail (2.3601.0.10)",       "@version": "1",     "elapsed": {       "Sending": 0.084,       "Total": 0.237,       "Amavis": 0.211,       "Decoding": 0.011,       "VirusCheck": 0.01,       "Receiving": 0.04     },     "ip_proto_trace": [       "LMTP://[199.89.1.14]:27486",       "ESMTPS://[64.237.50.187]:38008",       "ESMTP://127.0.0.1",       "LMTP://127.0.0.1",       "ESMTPSA://99.87.204.75"     ],     "tags": [       "amavisd",       "_amavis_json_direct"     ],        "dst_ip": "127.0.0.1",     "size": 2483,     "recipients": [       {         "bullshit for am": "am bullshit", "smtp_code": "250-new-am",         "rid": "1168521860-new-am",         "rcpt_to": "AM@TERRAMAR.NET-new-am",         "queued_as": "47b8gL2LMjz1JBRV-new-am",         "ccat_main": "CleanTag-new-am",         "action": "PASS-new-am",         "smtp_response": "250 2.0.0 from MTA(smtp:[127.0.0.1]:10025): 250 2.0.0 Ok: queued as 47b8gL2LMjz1JBRV-new-am",         "rcpt_is_local": false,         "whitelisted": false       },       {         "smtp_code": "250-new-tj",         "rid": "1168183819-new-tj",         "rcpt_to": "TJ@TERRAMAR.NET-new-tj",         "queued_as": "47b8gL2VHsz1JBSp-new-tj",         "ccat_main": "CleanTag-new-tj",         "action": "PASS-new-tj",         "smtp_response": "250 2.0.0 from MTA(smtp:[127.0.0.1]:10025): 250 2.0.0 Ok: queued as 47b8gL2VHsz1JBSp-new-tj",         "rcpt_is_local": true,         "whitelisted": true       }     ],     "digest_body": "b7eb6675bacb864210aa5cbd5c1f9576",     "checks_performed": "V H B D",     "client_port": 38008,     "time_iso_week_date": "2019-W50-7",     "src_ip": "199.89.1.14",     "time_unix": 1576379758.158,     "to_addr": [       "tj@terramar.net",       "am@terramar.net"     ],     "message_id": "<41DD3C31-8C17-4B63-BB20-7F5C7DB89576@mailroute.net>",     "ip_trace": [       "199.89.1.14",       "64.237.50.187",       "99.87.204.75"     ],     "mail_from": "TJ@MAILROUTE.net",     "action": [       "PASS-old"     ],     "actions_performed": "RelayedInbound Quarantined",     "dst_port": 10024,     "originating": false,     "dsn_sent": false,     "rcpt_num": 2,     "author": [       "tj@mailroute.net"     ],     "rcpt_to": [       "am@terramar.net-old",       "tj@terramar.net-old"     ],     "subject": "testing to two people",     "subject_rot13": "grfgvat gb gjb crbcyr",     "dkim_author_sig": "mailroute.net"   } 



